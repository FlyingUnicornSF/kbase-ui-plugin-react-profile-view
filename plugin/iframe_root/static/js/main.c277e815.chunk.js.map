{"version":3,"sources":["assets/nouserpic.png","redux/reducer.ts","components/Profile.tsx","components/Narratives.tsx","util/dateDisplay.tsx","util/API.tsx","components/SearchUsers.tsx","components/SearchUsersRedux.tsx","pages/Home.tsx","pages/HomeRedux.tsx","App.tsx","redux/store.ts","index.tsx"],"names":["module","exports","__webpack_require__","p","reducer","state","action","baseState","baseReducer","Meta","Profile","props","gravatar","profile","userProfile","jobTitle","gravatarURL","affiliations","title","organization","started","ended","researchInterests","orgs","name","url","profileloading","profileloaded","orgloading","orgsloaded","Array","isArray","jobTitleOther","gravatarHash","gravatarDefault","react_default","a","createElement","style","maxWidth","margin","alt","src","nouserpic","es_row","padding","gutter","col","span","card","loading","textAlign","userName","userID","department","city","country","fundingSource","map","interest","key","org","href","target","rel","researchStatement","position","index","Narratives","data","narrativesloaded","colums","dataIndex","width","render","text","row","wsID","sorter","b","nameA","toUpperCase","nameB","day","date","delta","Date","now","dayString","toString","slice","dayAndTime","toFixed","dateDisplay","last_saved","popover","placement","content","lastSavedA","lastSavedB","i","narratives","length","narrative","permission","Object","keys","users","push","narrativeDetail","user","creator","table","columns","dataSource","bffServiceUrl","serviceUrl","_callee","id","response","regenerator_default","wrap","_context","prev","next","fetch","method","sent","status","console","warn","error","abrupt","json","t0","stop","fetchNarrativesAPI","_x2","_x3","_fetchNarrativesAPI","apply","this","arguments","_callee2","param","token","_context2","headers","Authorization","_callee3","_context3","_callee4","searchValue","body","stringBody","res","_context4","version","params","filter","JSON","stringify","mode","Content-Type","_callee5","authMeUrl","res_json","_context5","t1","Option","SearchUsers","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","mouseLeave","onChangeHandler","bind","assertThisInitialized","onSearchHandler","onMouseLeaveHandler","onMouseEnterHandler","value","_this2","_x6","_x7","_filteredUserAPI","filteredUserAPI","then","setState","username","realname","window","open","es_select","allowClear","showSearch","placeholder","showArrow","onSearch","onChange","onMouseLeave","onMouseEnter","optionFilterProp","filterOption","inputValue","option","item","React","Component","connect","mapStateToProps","components_SearchUsers","hostName","TabPane","tabs","Home","proxy","tabTitle","loggedInUser","postalCode","avatarOption","userProfileLoaded","narrativesLoaded","sharedNarratives","sharedNarrativesLoaded","organizations","organizationsLoaded","location","search","replace","_x","_fetchProfileAPI","fetchProfileAPI","_x4","_x5","_fetchOrgsOfProfileAPI","fetchOrgsOfProfileAPI","orgArr","forEach","_x8","_fetchLoggedInUserAPI","fetchLoggedInUserAPI","userid","narrative_detail","publicNarratives","Promise","all","values","sharedNarrativeList","narrativeList","allNarratives","concat","prevProps","prevState","type","defaultActiveKey","tab","components_Profile","components_Narratives","components_SearchUsersRedux","log","pages_Home","Content","store","createStore","baseStoreState","makeBaseStoreState","objectSpread","makeInitialStoreState","compose","applyMiddleware","thunk","App","es","lib","className","layout","minHeight","backgroundColor","pages_HomeRedux","ReactDOM","src_App_0","document","getElementById"],"mappings":"6EAAAA,EAAAC,QAAiBC,EAAAC,EAAuB,yQCazBC,EAR0C,SAACC,EAA+BC,GACvF,IAAMC,EAAYC,sBAAYH,EAAyBC,GACvD,OAAIC,GAGGF,iJCNDI,WA4IOC,MAtHf,SAAiBC,GACb,IAgBIC,EAhBEC,EAAUF,EAAMG,YAElBC,EAAW,GACXC,EAAc,GACdC,EAAe,CAAC,CAChBC,MAAO,GACPC,aAAc,GACdC,QAAS,GACTC,MAAO,KAEPC,EAAkC,GAClCC,EAAO,CAAC,CACJC,KAAM,GACNC,IAAK,KAETC,GAAiB,EAEjBf,EAAMgB,gBACND,GAAiB,GAErB,IAAIE,GAAa,EAkCjB,OAjCIjB,EAAMkB,aACND,GAAa,GAGoB,qBAAzBf,EAAQI,eAChBA,EAAeJ,EAAQI,cAIc,qBAA9BJ,EAAQS,mBAAqCQ,MAAMC,QAAQlB,EAAQS,qBAC1EA,EAAoBT,EAAQS,mBAI5BP,EADsB,UAArBF,EAAQE,UAAoD,qBAArBF,EAAQE,SACrCF,EAAQmB,cACiB,qBAArBnB,EAAQE,SACZF,EAAQE,SAER,GAGZJ,EAAMY,OACLA,EAAOZ,EAAMY,MAGe,cAA5BV,EAAO,cAAqCF,EAAMsB,aAE3CtB,EAAMsB,eACbjB,EAAc,mCAAqCL,EAAMsB,aAAe,qBAAuBpB,EAAQqB,gBACvGtB,EAAWuB,EAAAC,EAAAC,cAAA,OAAKC,MAAO,CAAEC,SAAU,OAAQC,OAAQ,WAAaC,IAAI,SAASC,IAAM1B,KAHnFJ,EAAWuB,EAAAC,EAAAC,cAAA,OAAKC,MAAO,CAAEC,SAAU,OAAQC,OAAQ,WAAaC,IAAI,SAASC,IAAMC,MAQnFR,EAAAC,EAAAC,cAAAO,EAAA,GAAKN,MAAO,CAAEO,QAAS,KACvBV,EAAAC,EAAAC,cAAAO,EAAA,GAAKE,OAAQ,GACTX,EAAAC,EAAAC,cAAAU,EAAA,GAAKC,KAAM,GACPb,EAAAC,EAAAC,cAAAY,EAAA,GAAMC,QAASxB,EAAgBY,MAAO,CAAEE,OAAQ,UAAWW,UAAW,WAErEvC,GAEDuB,EAAAC,EAAAC,cAAAY,EAAA,GAAMC,QAASxB,EAAgBY,MAAO,CAAEE,OAAQ,UAAWW,UAAW,QAASjC,MAAOP,EAAMyC,SAAS5B,MACjGW,EAAAC,EAAAC,cAAC5B,EAAD,CAAMS,MAAM,YACZiB,EAAAC,EAAAC,cAAA,SAAI1B,EAAMyC,SAASC,QACnBlB,EAAAC,EAAAC,cAAC5B,EAAD,CAAMS,MAAM,aACZiB,EAAAC,EAAAC,cAAA,SAAItB,GACJoB,EAAAC,EAAAC,cAAC5B,EAAD,CAAMS,MAAM,eACZiB,EAAAC,EAAAC,cAAA,SAAIxB,EAAQyC,YACZnB,EAAAC,EAAAC,cAAC5B,EAAD,CAAMS,MAAM,iBACZiB,EAAAC,EAAAC,cAAA,SAAIxB,EAAQM,cACZgB,EAAAC,EAAAC,cAAC5B,EAAD,CAAMS,MAAM,aACZiB,EAAAC,EAAAC,cAAA,SAAIxB,EAAQ0C,KAAZ,KAAoB1C,EAAQR,MAA5B,KAAqCQ,EAAQ2C,SAC7CrB,EAAAC,EAAAC,cAAC5B,EAAD,CAAMS,MAAM,2BACZiB,EAAAC,EAAAC,cAAA,SAAIxB,EAAQ4C,iBAGpBtB,EAAAC,EAAAC,cAAAU,EAAA,GAAKC,KAAM,IACPb,EAAAC,EAAAC,cAAAO,EAAA,GAAKE,OAAQ,GACTX,EAAAC,EAAAC,cAAAU,EAAA,GAAKC,KAAM,IACPb,EAAAC,EAAAC,cAAAY,EAAA,GAAMC,QAASxB,EAAgBY,MAAO,CAAEE,OAAQ,WAAatB,MAAM,sBAC/DiB,EAAAC,EAAAC,cAAA,MAAIC,MAAO,CAACa,UAAW,SAClB7B,EAAkBoC,IAAI,SAAAC,GAAQ,OAC3BxB,EAAAC,EAAAC,cAAA,MAAIuB,IAAKD,GAAWA,QAKpCxB,EAAAC,EAAAC,cAAAU,EAAA,GAAKC,KAAM,IACPb,EAAAC,EAAAC,cAAAY,EAAA,GAAMC,QAAStB,EAAYU,MAAO,CAAEE,OAAQ,WAAatB,MAAM,iBAC3DiB,EAAAC,EAAAC,cAAA,MAAIC,MAAO,CAACa,UAAW,SAClB5B,EAAKmC,IAAI,SAACG,GAAD,OACN1B,EAAAC,EAAAC,cAAA,MAAIuB,IAAKC,EAAIrC,MAAMW,EAAAC,EAAAC,cAAA,KAAGyB,KAAMD,EAAIpC,IAAKsC,OAAO,SAASC,IAAI,uBAAuBH,EAAIrC,aAMxGW,EAAAC,EAAAC,cAAAO,EAAA,OAEIT,EAAAC,EAAAC,cAAAY,EAAA,GAAMC,QAASxB,EAAgBY,MAAO,CAAEE,OAAQ,WAAatB,MAAM,kCAC9DL,EAAQoD,mBAEb9B,EAAAC,EAAAC,cAAAY,EAAA,GAAMC,QAASxB,EAAgBY,MAAO,CAAEE,OAAQ,WAAatB,MAAM,gBAC/DiB,EAAAC,EAAAC,cAAA,MAAIC,MAAO,CAACa,UAAW,SAClBlC,EAAayC,IAAI,SAACQ,EAAUC,GAAX,OACdhC,EAAAC,EAAAC,cAAA,MAAIuB,IAAKO,GAAQD,EAAShD,MAA1B,MAAoCgD,EAAS/C,aAA7C,MAA8D+C,EAAS9C,QAAvE,MAAmF8C,EAAS7C,MAA5F,kDCzBjB+C,MAhFf,SAAoBzD,GAChB,IAAI0D,EAAyB,GACzBnB,GAAU,EACTvC,EAAM2D,mBACPpB,GAAU,GA+Cd,IA5CA,IAAMqB,EAAS,CACX,CACIrD,MAAO,QAASsD,UAAW,OAAQC,MAAO,IAAKb,IAAK,OACpDc,OAAO,SAACC,EAAaC,GACjB,IAAInD,EAAM,iCAAmCmD,EAAIC,KACjD,OACI1C,EAAAC,EAAAC,cAAA,KAAGyB,KAAMrC,EAAKsC,OAAO,SAASC,IAAI,uBAAuBW,IAGjEG,OAAQ,SAAC1C,EAAc2C,GACnB,IAAIC,EAAQ5C,EAAEZ,KAAKyD,cACfC,EAAQH,EAAEvD,KAAKyD,cACnB,OAAID,EAAQE,GACA,EAERF,EAAQE,EACD,EAEJ,IAGf,CACIhE,MAAO,aAAcsD,UAAW,aAAcC,MAAO,IACrDC,OAAQ,SAACC,EAAaC,GAClB,IAAIO,ECrDb,SAAqBC,GACxB,IAAIC,GAASC,KAAKC,OAAS,IAAID,KAAKF,IAAO,IACvCI,EAAa,IAAIF,KAAKF,GAAOK,WAE7BN,EAAMK,EAAUE,MAAM,EAAG,GAAK,IAAMF,EAAUE,MAAM,EAAG,IAAM,IAAMF,EAAUE,MAAM,GAAI,IAEvFC,EAAaR,EAAM,IAAMK,EAAUE,MAAM,GAAI,IACjD,OAAIL,GAAS,KAEF,CAACM,EAAYR,GACbE,EAAQ,MAAQA,GAAS,KAGzB,CAACM,GADIN,EAAO,MAAOO,QAAQ,GACP,aAEtBP,EAAQ,MAAQA,GAAS,IACvB,CAACF,GAAME,EAAM,KAAKO,QAAQ,GAAK,cAChCP,EAAQ,KAAOA,GAAS,IACvB,CAACM,GAAqB,GAAPN,GAAWO,QAAQ,GAAK,YAEvC,CAACD,EAAY,uBDiCFE,CAAYjB,EAAIkB,YAC1B,OACA3D,EAAAC,EAAAC,cAAA0D,EAAA,GAASC,UAAU,QAAQC,QAASd,EAAI,IACnCA,EAAI,KAGbL,OAAQ,SAAC1C,EAAc2C,GACnB,IAAImB,EAAa9D,EAAE0D,WACfK,EAAapB,EAAEe,WACnB,OAAII,EAAaC,EACN,EAEPD,EAAaC,GACL,EAEL,KAKVC,EAAI,EAAGA,EAAIzF,EAAM0F,WAAWC,OAAQF,GAAK,EAAG,CACjD,IAAIG,EAAY5F,EAAM0F,WAAWD,GACjC,GAA6B,MAAzBG,EAAUC,YAA+C,MAAzBD,EAAUC,WACtCC,OAAOC,KAAKH,EAAUI,OAAOL,OAC7BjC,EAAKuC,KAAK,CAAEhD,IAAO2C,EAAU1B,KAAMA,KAAQ0B,EAAU1B,KAAMrD,KAAQ+E,EAAU/E,KAAMsE,WAAcS,EAAUT,iBAI5G,CACH,IAAMe,EAAmCN,EAAS,iBAC9CI,EAAQ,GACZ,IAAK,IAAIG,KAAQP,EAAUI,MACnBG,IAASD,EAAgBE,UACzBJ,EAAQA,EAAQG,EAAO,MAE/BzC,EAAKuC,KAAK,CAAEhD,IAAO2C,EAAU1B,KAAMA,KAAQ0B,EAAU1B,KAAMrD,KAAS+E,EAAU/E,KAAMsE,WAAcS,EAAUT,cAIpH,OACI3D,EAAAC,EAAAC,cAAA2E,EAAA,GACI1E,MAAO,CAAEmC,MAAO,MAAOjC,OAAQ,QAC/ByE,QAAS1C,EACT2C,WAAY7C,EACZnB,QAASA,yDEvGfiE,EAAgB,wBAGhBC,EAAa,uEAOZ,SAAAC,EAA+BC,GAA/B,IAAA7F,EAAA8F,EAAA1G,EAAA,OAAA2G,EAAApF,EAAAqF,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cACCnG,EAAM0F,EAAgB,qBAAuBG,EAD9CI,EAAAE,KAAA,EAEoBC,MAAMpG,EAAK,CAC9BqG,OAAQ,QAHT,UAKqB,OAHlBP,EAFHG,EAAAK,MAKUC,OALV,CAAAN,EAAAE,KAAA,QAMCK,QAAQC,KAAK,gBAAiBX,GAN/BG,EAAAE,KAAA,mBAQ0B,MAApBL,EAASS,OARf,CAAAN,EAAAE,KAAA,gBASCK,QAAQE,MAAM,gBAAiBZ,GAThCG,EAAAU,OAAA,yBAAAV,EAAAC,KAAA,GAAAD,EAAAE,KAAA,GAauBL,EAASc,OAbhC,eAaOxH,EAbP6G,EAAAK,KAAAL,EAAAU,OAAA,SAcQvH,GAdR,QAAA6G,EAAAC,KAAA,GAAAD,EAAAY,GAAAZ,EAAA,UAiBCO,QAAQE,MAAM,uBAAwBZ,GAjBvC,yBAAAG,EAAAa,SAAAlB,EAAA,0CA2BA,SAAemB,EAAtBC,EAAAC,GAAA,OAAAC,EAAAC,MAAAC,KAAAC,sDAAO,SAAAC,EAAkCC,EAAcC,GAAhD,IAAAxH,EAAA8F,EAAAlB,EAAA,OAAAmB,EAAApF,EAAAqF,KAAA,SAAAyB,GAAA,cAAAA,EAAAvB,KAAAuB,EAAAtB,MAAA,cACCnG,EAAM0F,EAAgB,mBAAmB6B,EAD1CE,EAAAtB,KAAA,EAEoBC,MAAMpG,EAAK,CAC9BqG,OAAQ,MACRqB,QAAS,CACLC,cAAeH,KALpB,UAQqB,OANlB1B,EAFH2B,EAAAnB,MAQUC,OARV,CAAAkB,EAAAtB,KAAA,eASCK,QAAQE,MAAM,iCAAkCZ,GATjD2B,EAAAd,OAAA,wBAAAc,EAAAvB,KAAA,EAAAuB,EAAAtB,KAAA,GAa0BL,EAASc,OAbnC,eAaOhC,EAbP6C,EAAAnB,KAAAmB,EAAAd,OAAA,SAcQ/B,GAdR,QAAA6C,EAAAvB,KAAA,GAAAuB,EAAAZ,GAAAY,EAAA,SAiBCjB,QAAQE,MAAM,0BAA2BZ,GAjB1C,yBAAA2B,EAAAX,SAAAQ,EAAA,oFA0BA,SAAAM,EAAqC/B,EAAW2B,GAAhD,IAAAxH,EAAA8F,EAAAhG,EAAA,OAAAiG,EAAApF,EAAAqF,KAAA,SAAA6B,GAAA,cAAAA,EAAA3B,KAAA2B,EAAA1B,MAAA,cACGnG,EAAM0F,EAAgB,aAAeG,EADxCgC,EAAA1B,KAAA,EAEoBC,MAAMpG,EAAK,CAC9BqG,OAAQ,MACRqB,QAAS,CACLC,cAAeH,KALpB,UAQqB,OANlB1B,EAFH+B,EAAAvB,MAQUC,OARV,CAAAsB,EAAA1B,KAAA,eASCK,QAAQE,MAAM,gBAAiBZ,GAThC+B,EAAAlB,OAAA,wBAAAkB,EAAA3B,KAAA,EAAA2B,EAAA1B,KAAA,GAaoBL,EAASc,OAb7B,eAaO9G,EAbP+H,EAAAvB,KAAAuB,EAAAlB,OAAA,SAcQ7G,GAdR,QAAA+H,EAAA3B,KAAA,GAAA2B,EAAAhB,GAAAgB,EAAA,SAiBCrB,QAAQE,MAAM,mBAAoBZ,GAjBnC,yBAAA+B,EAAAf,SAAAc,EAAA,oFA0BA,SAAAE,EAA+BC,EAAoBP,GAAnD,IAAAQ,EAAAC,EAAAjI,EAAA8F,EAAAoC,EAAA,OAAAnC,EAAApF,EAAAqF,KAAA,SAAAmC,GAAA,cAAAA,EAAAjC,KAAAiC,EAAAhC,MAAA,cACG6B,EAAO,CACTI,QAAW,MACX/B,OAAU,2BACVgC,OAAU,CAAC,CAACC,OAAUP,KAEpBE,EAAaM,KAAKC,UAAUR,GAE5BhI,EAAM2F,EAAa,oBARtBwC,EAAAhC,KAAA,EASoBC,MAAMpG,EAAI,CAC7BqG,OAAQ,OACRoC,KAAM,OACNf,QAAS,CACLC,cAAeH,EACfkB,eAAgB,oBAEpBV,KAAMC,IAhBP,UAkBqB,OATlBnC,EATHqC,EAAA7B,MAkBUC,OAlBV,CAAA4B,EAAAhC,KAAA,eAmBCK,QAAQE,MAAM,gBAAiBZ,GAnBhCqC,EAAAxB,OAAA,wBAAAwB,EAAAjC,KAAA,EAAAiC,EAAAhC,KAAA,GAuBmBL,EAASc,OAvB5B,eAuBOsB,EAvBPC,EAAA7B,KAAA6B,EAAAxB,OAAA,SA2BQuB,GA3BR,QAAAC,EAAAjC,KAAA,GAAAiC,EAAAtB,GAAAsB,EAAA,SA8BC3B,QAAQE,MAAM,4BAA6BZ,GA9B5C,yBAAAqC,EAAArB,SAAAgB,EAAA,oFAsCA,SAAAa,EAAoCnB,GAApC,IAAAoB,EAAA9C,EAAA+C,EAAA,OAAA9C,EAAApF,EAAAqF,KAAA,SAAA8C,GAAA,cAAAA,EAAA5C,KAAA4C,EAAA3C,MAAA,cACGyC,EAAYjD,EAAa,WAD5BmD,EAAA5C,KAAA,EAAA4C,EAAA3C,KAAA,EAIkBC,MAAMwC,EAAW,CAC9BvC,OAAQ,MACRoC,KAAM,OACNf,QAAS,CACLC,cAAeH,EACfkB,eAAgB,sBATzB,OAIC5C,EAJDgD,EAAAxC,KAAAwC,EAAA3C,KAAA,gBAAA2C,EAAA5C,KAAA,EAAA4C,EAAAjC,GAAAiC,EAAA,SAeCtC,QAAQE,MAAM,2BAAdoC,EAAAjC,IAfD,YAiBEf,EAjBF,CAAAgD,EAAA3C,KAAA,gBAAA2C,EAAA5C,KAAA,GAAA4C,EAAA3C,KAAA,GAmB4BL,EAASc,OAnBrC,eAmBWiC,EAnBXC,EAAAxC,KAAAwC,EAAAnC,OAAA,SAoBYkC,EAASxD,MApBrB,QAAAyD,EAAA5C,KAAA,GAAA4C,EAAAC,GAAAD,EAAA,UAuBKtC,QAAQE,MAAM,2BAAdoC,EAAAC,IAvBL,yBAAAD,EAAAhC,SAAA6B,EAAA,oDC3HCK,aA8FOC,cApEX,SAAAA,EAAY/J,GAAa,IAAAgK,EAAA,OAAAlE,OAAAmE,EAAA,EAAAnE,CAAAoC,KAAA6B,IACrBC,EAAAlE,OAAAoE,EAAA,EAAApE,CAAAoC,KAAApC,OAAAqE,EAAA,EAAArE,CAAAiE,GAAAK,KAAAlC,KAAMlI,KACDN,MAAQ,CACTgE,KAAM,GACN2G,YAAY,GAEhBL,EAAKM,gBAAkBN,EAAKM,gBAAgBC,KAArBzE,OAAA0E,EAAA,EAAA1E,CAAAkE,IACvBA,EAAKS,gBAAkBT,EAAKS,gBAAgBF,KAArBzE,OAAA0E,EAAA,EAAA1E,CAAAkE,IACvBA,EAAKU,oBAAsBV,EAAKU,oBAAoBH,KAAzBzE,OAAA0E,EAAA,EAAA1E,CAAAkE,IAC3BA,EAAKW,oBAAsBX,EAAKW,oBAAoBJ,KAAzBzE,OAAA0E,EAAA,EAAA1E,CAAAkE,IATNA,+EAaTY,GAAmB,IAAAC,EAAA3C,KAC5B0C,EAAMjF,OAAO,IAAgC,IAA1BuC,KAAKxI,MAAM2K,YD6ClC,SAAPS,EAAAC,GAAA,OAAAC,EAAA/C,MAAAC,KAAAC,WC5CY8C,CAAgBL,EAAO1C,KAAKlI,MAAMsI,OACjC4C,KAAK,SAACtE,GACoB,qBAAbA,EACNiE,EAAKM,SAAS,CAACzH,KAAMkD,EAAQ,OAAW,KAGxCiE,EAAKM,SAAS,CAACzH,KAAM,CACjB,CAAE0H,SAAU,QAASC,SAAU,6FAO/CnD,KAAKiD,SAAU,CAAEd,YAAY,kDAG7BnC,KAAKiD,SAAU,CAAEd,YAAY,4CAEjBO,GACZ,GAAa,UAAVA,GAAsC,qBAAVA,EAAuB,CAClD,IAAI9J,EAAM,0BAA4B8J,EAEtCU,OAAOC,KAAKzK,EAAK,4CAKrB,IAAI4C,EAAOwE,KAAKxI,MAAMgE,KACtB,OACIlC,EAAAC,EAAAC,cAAA8J,EAAA,GACIjC,KAAK,SAAS5H,MAAO,CAAEmC,MAAO,KAC9B2H,YAAU,EACVC,YAAU,EACVC,YAAY,+BACZC,WAAW,EACXC,SAAU3D,KAAKuC,gBACfqB,SAAU5D,KAAKoC,gBACfyB,aAAc7D,KAAKwC,oBACnBsB,aAAc9D,KAAKyC,oBACnBsB,iBAAiB,WACjBC,aAAc,SAACC,EAAYC,GACvB,OAAO,IAGV1I,EAAKX,IAAI,SAACsJ,GACR,OAAQ7K,EAAAC,EAAAC,cAACoI,EAAD,CAAQ7G,IAAKoJ,EAAI,UAAeA,EAAI,SAApC,KAAoDA,EAAI,SAAxD,eA9DDC,IAAMC,WCXjBC,wBATS,SAAC9M,GACrB,OAAOA,GAQI8M,CANf,SAA0BC,GACtB,OACIjL,EAAAC,EAAAC,cAACgL,EAAD,CAAapE,MAAOmE,EAAgBnE,MAAOqE,SAAUF,EAAgBE,aCPvEC,EAAUC,EAAA,EAAKD,QAuXNE,cAjSX,SAAAA,EAAY9M,GAAc,IAAAgK,EAAA,OAAAlE,OAAAmE,EAAA,EAAAnE,CAAAoC,KAAA4E,IACtB9C,EAAAlE,OAAAoE,EAAA,EAAApE,CAAAoC,KAAApC,OAAAqE,EAAA,EAAArE,CAAAgH,GAAA1C,KAAAlC,KAAMlI,KACDN,MAAQ,CACT4I,MAAO,mCACPyE,MAAO,6BACPC,SAAU,CAAC,UAAW,aAAc,oBAAqB,gBACzDvK,SAAU,CACN5B,KAAM,GACN6B,OAAQ,IAEZuK,aAAc,GACd9M,YAAa,CACTK,aAAc,GACdmC,WAAY,GACZC,KAAM,GACNlD,MAAO,GACPwN,WAAY,GACZrK,QAAS,GACTvC,aAAc,GACdgD,kBAAmB,GACnBlD,SAAU,GACViB,cAAe,GACfV,kBAAmB,GACnBmC,cAAe,GACfvB,gBAAiB,GACjB4L,aAAc,IAElBC,mBAAmB,EACnB1H,WAAY,GACZ2H,kBAAkB,EAClBC,iBAAkB,GAClBC,wBAAwB,EACxBC,cAAe,GACfC,qBAAqB,EACrBnM,aAAc,IAlCI0I,mFAuCN,IAAAa,EAAA3C,KACVxF,EAAS4I,OAAOoC,SAASC,OAAOC,QAAQ,IAAK,KH3HpD,SAAPC,GAAA,OAAAC,EAAA7F,MAAAC,KAAAC,YGgIQ4F,CAAgBrL,GACXwI,KAAK,SAACtE,GACoB,qBAAbA,EACNiE,EAAKM,SAAS,CACV1I,SAAU,CACN5B,KAAM+F,EAAQ,KAAR,SACNlE,OAAQkE,EAAQ,KAAR,UAEZtF,aAAcsF,EAAQ,QAAR,oBACdzG,YAAayG,EAAQ,QAAR,SACbwG,mBAAmB,IAIvBvC,EAAKM,SAAS,CACV1I,SAAU,CACN5B,KAAM,yEACN6B,OAAQ,QH5F7B,SAAPsL,EAAAC,GAAA,OAAAC,EAAAjG,MAAAC,KAAAC,WGsGQgG,CAAsBzL,EAAQwF,KAAKxI,MAAM4I,OACpC4C,KAAK,SAACtE,GACH,IAAIwH,EAAyB,GACL,qBAAbxH,GACPA,EAASyH,QAAQ,SAAAnL,GACbkL,EAAOnI,KAAK,CAAEpF,KAAQqC,EAAIrC,KAAMC,IAAO+J,EAAKnL,MAAMqN,MAAQ,SAAW7J,EAAIyD,OAE7EkE,EAAKM,SACD,CACIqC,cAAeY,EACfX,qBAAqB,KAK7B5C,EAAKM,SACD,CACIqC,cAAe,CAAC,CAAC3M,KAAM,iEAAkEC,IAAI,KAC7F2M,qBAAqB,MHxD1C,SAAPa,GAAA,OAAAC,EAAAtG,MAAAC,KAAAC,WGwEQqG,CAAqBtG,KAAKxI,MAAM4I,OAC3B4C,KAAK,SAACtE,GACH,GAAuB,qBAAbA,EAAV,CAoBI,IAAM6H,EAASnD,OAAOoC,SAASC,OAAOC,QAAQ,IAAK,IAEnD,GADA/C,EAAKM,SAAS,CAAE8B,aAAcrG,IAC1BA,IAAa6H,EACb5G,EAAmB,OAAQgD,EAAKnL,MAAM4I,OACrC4C,KAAK,SAACtE,GACgB,qBAAbA,EACNiE,EAAKM,SACD,CACIzF,WAAYkB,EACZyG,kBAAkB,IAK1BxC,EAAKM,SACD,CACIzF,WAAY,CACR,CACIxB,KAAM,GACN2B,WAAY,GACZhF,KAAM,iEACNsE,WAAY,EACZa,MAAO,GACP0I,iBAAkB,CAACtI,QAAS,MAGpCiH,kBAAkB,MAKlCxF,EAAmB,SAAUgD,EAAKnL,MAAM4I,OACnC4C,KAAK,SAACtE,GACoB,qBAAbA,EACNiE,EAAKM,SACD,CACImC,iBAAkB1G,EAClB2G,wBAAwB,IAKhC1C,EAAKM,SACD,CACImC,iBAAkB,CACd,CACIpJ,KAAM,GACN2B,WAAY,GACZhF,KAAM,iEACNsE,WAAY,EACZa,MAAO,GACP0I,iBAAkB,CAACtI,QAAS,MAGpCmH,wBAAwB,UAKzC,CACH,IAAIoB,EAAmB9G,EAAmB,SAAUgD,EAAKnL,MAAM4I,OAC1D4C,KAAK,SAACtE,GACH,GAAuB,qBAAbA,EAmBV,OAAOA,EAjBHiE,EAAKM,SACD,CACIzF,WAAY,CACR,CACIxB,KAAM,GACN2B,WAAY,GACZhF,KAAM,iEACNsE,WAAY,EACZa,MAAO,GACP0I,iBAAkB,CAACtI,QAAS,MAGpCiH,kBAAkB,MAOlCC,EAAmBzF,EAAmB,SAAUgD,EAAKnL,MAAM4I,OAC1D4C,KAAK,SAACtE,GAAqC,OAAOA,IACvDgI,QAAQC,IAAI,CAACF,EAAkBrB,IAAmBpC,KAC9C,SAAC4D,GACG,IAAIC,EAAsB,GAC1B,GAAwB,qBAAdD,EAAO,GACb,IAAK,IAAIrJ,EAAI,EAAGA,EAAIqJ,EAAO,GAAGnJ,OAAQF,IAAK,CACvC,IAAIG,EAAYkJ,EAAO,GAAGrJ,GAC1B,GAAIG,EAAU8I,iBAAiBtI,UAAY1D,EACvC,IAAK,IAAIyD,KAAQP,EAAUI,MACnBG,IAASzD,GACTqM,EAAoB9I,KAAKL,GAO7C,IAAIoJ,EAAgB,GACpB,GAAwB,qBAAdF,EAAO,GAEb,IADA,IAAIG,EAAgBH,EAAO,GAAGI,OAAOJ,EAAO,IACnCrJ,EAAI,EAAGA,EAAIwJ,EAActJ,OAAQF,GAAK,EACvCwJ,EAAcxJ,GAAd,2BAAoDgJ,GACpDO,EAAc/I,KAAKgJ,EAAcxJ,IAI7CoF,EAAKM,SACD,CACIzF,WAAYsJ,EACZ3B,kBAAkB,EAClBC,iBAAkByB,EAClBxB,wBAAwB,YArIxC1C,EAAKM,SACD,CACIzF,WAAY,CACR,CACIxB,KAAM,GACN2B,WAAY,GACZhF,KAAM,iEACNsE,WAAY,EACZa,MAAO,GACP0I,iBAAkB,CAACtI,QAAS,MAGpCiH,kBAAkB,iDAkIvB8B,EAAgBC,GAE3BlH,KAAKxI,uCAMT,OACI8B,EAAAC,EAAAC,cAAAmL,EAAA,GAAMwC,KAAK,OAAOC,iBAAiB,KAC/B9N,EAAAC,EAAAC,cAACkL,EAAD,CAAS2C,IAAI,UAAUtM,IAAI,KACvBzB,EAAAC,EAAAC,cAAC8N,EAAD,CACI/M,SAAUyF,KAAKxI,MAAM+C,SACrBtC,YAAa+H,KAAKxI,MAAMS,YACxBS,KAAMsH,KAAKxI,MAAM8N,cACjBlM,aAAc4G,KAAKxI,MAAM4B,aACzBN,cAAekH,KAAKxI,MAAM0N,kBAC1BlM,WAAYgH,KAAKxI,MAAM+N,oBACvBnF,MAAOJ,KAAKlI,MAAMsI,SAG1B9G,EAAAC,EAAAC,cAACkL,EAAD,CAAS2C,IAAI,aAAatM,IAAI,KAC1BzB,EAAAC,EAAAC,cAAC+N,EAAD,CACIxC,aAAc/E,KAAKxI,MAAMuN,aACzBvH,WAAYwC,KAAKxI,MAAMgG,WACvB/B,iBAAkBuE,KAAKxI,MAAM2N,iBAC7B/E,MAAOJ,KAAKlI,MAAMsI,SAG1B9G,EAAAC,EAAAC,cAACkL,EAAD,CAAS2C,IAAI,qBAAqBtM,IAAI,KAClCzB,EAAAC,EAAAC,cAAEgO,EAAF,eA3RDpD,IAAMC,WC5EVC,wBAVS,SAAC9M,GAErB,OADA4H,QAAQqI,IAAIjQ,GACLA,GAQI8M,CANf,SAAmBC,GACf,OACIjL,EAAAC,EAAAC,cAACkO,EAAD,CAAM3C,aAAcR,EAAgBQ,aAAc3E,MAAOmE,EAAgBnE,MAAOqE,SAAUF,EAAgBE,aCJ1GkD,cACFC,ECMGC,YAAYtQ,EARd,WACL,IAAMuQ,EAAiBC,+BACvB,OAAOnK,OAAAoK,EAAA,EAAApK,CAAA,GACFkK,GAKuBG,GAAyBC,YAAQC,YAAgBC,ODgBhEC,EAlBO,WAClB,OACI/O,EAAAC,EAAAC,cAAC8O,EAAA,SAAD,CAAUV,MAAOA,GACbtO,EAAAC,EAAAC,cAAC+O,EAAA,WAAD,KACIjP,EAAAC,EAAAC,cAAC+O,EAAA,QAAD,KACIjP,EAAAC,EAAAC,cAAA,OAAKgP,UAAU,OACXlP,EAAAC,EAAAC,cAAAiP,EAAA,GAAQhP,MAAO,CAAEiP,UAAW,UACxBpP,EAAAC,EAAAC,cAACmO,EAAD,CAASlO,MAAO,CAAEkP,gBAAiB,UAC/BrP,EAAAC,EAAAC,cAACoP,EAAD,aEhBhCC,IAAShN,OAAOvC,EAAAC,EAAAC,cAACsP,EAAD,MAASC,SAASC,eAAe","file":"static/js/main.c277e815.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/nouserpic.9af42ba9.png\";","import { Action, Reducer } from \"redux\";\nimport { baseReducer } from \"@kbase/ui-lib\";\nimport { BaseStoreState } from \"@kbase/ui-lib\";\nimport { StoreState } from \"./store\";\n\nconst reducer: Reducer<StoreState | undefined, Action> = (state: StoreState | undefined, action: Action) => {\n  const baseState = baseReducer(state as BaseStoreState, action);\n  if (baseState) {\n    return baseState as StoreState;\n  }\n  return state;\n};\n\nexport default reducer;","import React from 'react';\nimport { UserName, ProfileData, OrgProp  } from '../pages/Home';\nimport { Row, Col, Card } from 'antd';\nimport nouserpic from '../assets/nouserpic.png';\nconst { Meta } = Card;\n\n/**\n *  Profile.tsx is a view component\n *  Parent componenet - pages/Home.tsx\n *  \n */\n\ninterface Props {\n    token: string;\n    userName: UserName;\n    userProfile: ProfileData;\n    orgs: Array<OrgProp>;\n    gravatarHash: string;\n    profileloaded: Boolean;\n    orgsloaded: Boolean;\n}\n\n/**\n * Returns profile component. \n * @param props \n */\nfunction Profile(props: Props){\n    const profile = props.userProfile;\n    // Set initial value to props for initial render and no-data\n    let jobTitle = '';\n    let gravatarURL = '';\n    let affiliations = [{\n        title: '',\n        organization: '',\n        started: '',\n        ended: ''\n    }]\n    let researchInterests:Array<string> = [];\n    let orgs = [{   \n            name: '',\n            url: ''\n        }];\n    let profileloading = true;\n    let gravatar;\n    if (props.profileloaded){\n        profileloading = false;\n    }\n    let orgloading = true;\n    if (props.orgsloaded){\n        orgloading = false;\n    }\n    // Set affiliations\n    if ( typeof profile.affiliations !== 'undefined') {\n        affiliations = profile.affiliations;\n    }\n\n    // Set researchInterests\n    if (typeof profile.researchInterests !== 'undefined' && Array.isArray(profile.researchInterests) ) {\n        researchInterests = profile.researchInterests\n    } \n    // Set jobTitle\n    if ( profile.jobTitle === 'Other' && typeof profile.jobTitle !== 'undefined' ) {\n        jobTitle = profile.jobTitleOther;\n    } else if ( typeof profile.jobTitle !== 'undefined' ){\n        jobTitle = profile.jobTitle;\n    } else {\n        jobTitle = '';\n    }\n    // set orgs\n    if(props.orgs){\n        orgs = props.orgs;\n    }\n    // Set gravatarURL\n    if (profile['avatarOption'] === 'silhoutte' || !props.gravatarHash) {\n        gravatar = <img style={{ maxWidth: '100%', margin: '8px 0px' }} alt='avatar' src={ nouserpic } />\n    } else if( props.gravatarHash ) {\n        gravatarURL = 'https://www.gravatar.com/avatar/' + props.gravatarHash + '?s=300&amp;r=pg&d=' + profile.gravatarDefault;\n        gravatar = <img style={{ maxWidth: '100%', margin: '8px 0px' }} alt='avatar' src={ gravatarURL } />\n    }\n\n\n    return (\n        <Row style={{ padding: 16 }}>\n        <Row gutter={8}>\n            <Col span={8}>\n                <Card loading={profileloading} style={{ margin: '8px 0px', textAlign: 'center'}}>\n                {/* <img style={{ maxWidth: '100%', margin: '8px 0px' }} alt='avatar' src={ gravatarURL } /> */}\n                {gravatar}\n                </Card>\n                <Card loading={profileloading} style={{ margin: '8px 0px', textAlign: 'left'}} title={props.userName.name}>\n                    <Meta title='User ID' />\n                    <p>{props.userName.userID}</p>\n                    <Meta title='Position' />\n                    <p>{jobTitle}</p>\n                    <Meta title='Department' />\n                    <p>{profile.department}</p>\n                    <Meta title='Organization' />\n                    <p>{profile.organization}</p>\n                    <Meta title='Location' />\n                    <p>{profile.city}, {profile.state}, {profile.country}</p>\n                    <Meta title='Primary Funding Source' />\n                    <p>{profile.fundingSource}</p>\n                </Card>\n            </Col>\n            <Col span={16}>\n                <Row gutter={8}>\n                    <Col span={12}>\n                        <Card loading={profileloading} style={{ margin: '8px 0px' }} title=\"Research Interests\">\n                            <ul style={{textAlign: \"left\"}}>\n                                {researchInterests.map(interest => (\n                                    <li key={interest}>{interest}</li>\n                                ))}\n                            </ul>\n                        </Card>\n                    </Col>\n                    <Col span={12}>\n                        <Card loading={orgloading} style={{ margin: '8px 0px' }} title=\"Organizations\">\n                            <ul style={{textAlign: \"left\"}}>\n                                {orgs.map((org) => (\n                                    <li key={org.name}><a href={org.url} target=\"_blank\" rel=\"noopener noreferrer\">{org.name}</a></li>\n                                ))}\n                            </ul>\n                        </Card>\n                    </Col>\n                </Row>\n                <Row>\n                    {/* TODO:AKIYO FIX - when the box is very small it doesn't break or hide word */}\n                    <Card loading={profileloading} style={{ margin: '8px 0px' }} title='Research or Personal Statement'>\n                        {profile.researchStatement}\n                    </Card>\n                    <Card loading={profileloading} style={{ margin: '8px 0px' }} title='Afflications'>\n                        <ul style={{textAlign: \"left\"}}>\n                            {affiliations.map((position, index) => (\n                                <li key={index}>{position.title} @ {position.organization},  {position.started} - {position.ended} </li>\n                            ))}\n                        </ul>\n                    </Card>\n                </Row>\n            </Col>\n        </Row>\n        </Row>\n    )\n}\n\nexport default Profile;\n\n","/**\n *  Narrative.tsx is a view component\n *  Parent componenet - pages/Home.tsx\n *  \n */\nimport React from 'react';\nimport { dateDisplay } from '../util/dateDisplay'; // date format\nimport { Table, Popover } from 'antd';\nimport { Narrative_detail, NarrativeData } from '../pages/Home'; //interface\n\ninterface TableData {\n    key: string;\n    wsID: string;\n    name: string;\n    last_saved: number;\n}\n\ninterface Props {\n    token: string;\n    loggedInUser: string;\n    narratives: Array<NarrativeData>;\n    narrativesloaded: Boolean;\n}\n\n/**\n * Returns a component with list of narratives in a table.\n * @param props \n */\nfunction Narratives(props: Props){\n    let data: Array<TableData> = [];\n    let loading = true;\n    if ( props.narrativesloaded ){\n        loading = false;\n    }\n    // initialize data for the table to be an empty array.\n    const colums = [\n        {\n            title: 'Title', dataIndex: 'name', width: 350, key: 'wsID',\n            render:(text:string, row:TableData) => {\n                let url = 'https://ci.kbase.us/narrative/' + row.wsID\n                return (\n                    <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">{text}</a>\n                );\n            },\n            sorter: (a: TableData, b: TableData) => {\n                let nameA = a.name.toUpperCase();\n                let nameB = b.name.toUpperCase();\n                if (nameA < nameB) {\n                    return -1;\n                }\n                if (nameA > nameB) {\n                    return 1;\n                }\n                return 0;\n            }\n        },\n        {\n            title: 'Last Saved', dataIndex: 'last_saved', width: 190,\n            render: (text:string, row:TableData) => {\n                let day = dateDisplay(row.last_saved);\n                return(\n                <Popover placement=\"right\" content={day[0]}>\n                    {day[1]}\n                </Popover>);\n            },\n            sorter: (a: TableData, b: TableData) => {\n                let lastSavedA = a.last_saved;\n                let lastSavedB = b.last_saved;\n                if (lastSavedA < lastSavedB) {\n                    return 1;\n                }\n                if (lastSavedA > lastSavedB) {\n                    return -1;\n                }\n                return 0;\n            }\n        }\n    ];\n\n    for (let i = 0; i < props.narratives.length; i += 1) {\n        let narrative = props.narratives[i];\n        if (narrative.permission === 'r' || narrative.permission === 'n') {\n            if (Object.keys(narrative.users).length <= 0) {\n                data.push({ 'key': narrative.wsID, 'wsID': narrative.wsID, 'name': narrative.name, 'last_saved': narrative.last_saved });\n            } else {\n                data.push({ 'key': narrative.wsID, 'wsID': narrative.wsID, 'name':  narrative.name, 'last_saved': narrative.last_saved, });\n            }\n        } else {\n            const narrativeDetail:Narrative_detail = narrative['narrative_detail']\n            let users = '';\n            for (let user in narrative.users) {\n                if (user !== narrativeDetail.creator)\n                    users = users + user + ', ';\n            }\n            data.push({ 'key': narrative.wsID, 'wsID': narrative.wsID, 'name':  narrative.name, 'last_saved': narrative.last_saved });\n        }\n    }\n\n    return (\n        <Table<TableData> \n            style={{ width: '85%', margin: 'auto' }} \n            columns={colums} \n            dataSource={data}\n            loading={loading}\n        />\n    )\n}\n\nexport default Narratives;","/**\n * returns array of date in MMM DD YYY HH:MM:SS and one of below:\n * less than a min ago, # hours ago, # days ago, day: MMM DD YYYY (if it's more than a month)\n * @param {string} date date format\n * \n */\nexport function dateDisplay(date: number): Array<string> {\n    let delta = (Date.now() - +new Date(date))/1000000 ;\n    let dayString = (new Date(date)).toString();\n    // date format: MMM DD YYYY\n    let day = dayString.slice(4, 7) + ' ' + dayString.slice(8, 10) + ' ' + dayString.slice(11, 15);\n    //  date format: MMM DD YYYY HH:MM:SS\n    let dayAndTime = day + ' ' + dayString.slice(16, 24);\n    if( delta >= 2628 ) {\n        // more than a month ago\n        return [dayAndTime, day];\n    } else if( delta < 2628 && delta >= 86.4) {\n        // less than a month ago, but more than a day ago\n        let days = (delta/(86.4)).toFixed(0);\n        return [dayAndTime, days + ' days ago'];\n    }\n    else if( delta < 86.4 && delta >= 3.6) {\n        return [day, (delta/3.6).toFixed(0) + ' hours ago'];\n    } else if(delta < 3.6 && delta >= 0.06) {\n        return [dayAndTime, ((delta)*10).toFixed(0) + ' min ago'];\n    } else {\n        return [dayAndTime, 'less than a min ago']\n    }\n};","const bffServiceUrl = 'http://localhost:5000';\n// TODO: make sure to get rid of local host 3000\n// TODO: response.json() It returns a promise so make sure to change all of them into await!  \nconst serviceUrl = 'https://kbase.us/services';\n\n\n/**\n * Return profile data\n * @param id profile id\n */\nexport async function fetchProfileAPI(id: string) {\n    let url = bffServiceUrl + '/fetchUserProfile/' + id;\n    const response = await fetch(url, {\n        method: 'GET'\n    });\n    if (response.status === 404) {\n        console.warn(\"404 response:\", response);\n    }\n    else if (response.status === 500) {\n        console.error(\"500 response:\", response);\n        return;\n    }\n    try {\n        const profile = await response.json();\n        return profile;\n    }\n    catch (err) {\n        console.error('profile fetch failed', response);\n    }\n    \n}\n\n/**\n * Return list of narratives\n * @param param shared/mine/public\n * @param token kbase session cookie\n */\nexport async function fetchNarrativesAPI(param:string, token:string) {\n    let url = bffServiceUrl + '/narrative_list/'+param;\n    const response = await fetch(url, {\n        method: 'GET',\n        headers: {\n            Authorization: token\n        }\n    });\n    if (response.status === 500) {\n        console.error(\"Fetch Narratives 500 response:\", response);\n        return;\n    }\n    try {\n        const narratives = await response.json();\n        return narratives;\n    }\n    catch (err) {\n        console.error('fetch narratives failed', response)\n    }\n}\n\n/**\n * returns list of orgs that profile and logged in user are both associated with.\n * @param id id of the profile \n * @param token kbase session cookie\n */\nexport async function fetchOrgsOfProfileAPI(id:string, token:string) {\n    const url = bffServiceUrl + '/org_list/' + id;\n    const response = await fetch(url, {\n        method: 'GET',\n        headers: {\n            Authorization: token\n        }\n    });\n    if (response.status === 500) {\n        console.error(\"500 response:\", response);\n        return;\n    }\n    try {\n        const orgs = await response.json();\n        return orgs;\n    }\n    catch (err) {\n        console.error('fetch org failed', response)\n    }\n}\n\n/**\n * returns list of users that are filtered by search values\n * @param searchValue search values\n * @param token kbase session cookie\n */\nexport async function filteredUserAPI(searchValue:string, token: string){\n    const body = {\n        'version': '1.1',\n        'method': 'UserProfile.filter_users',\n        'params': [{'filter': searchValue}]\n    }\n    const stringBody = JSON.stringify(body);\n\n    const url = serviceUrl + '/user_profile/rpc'\n    const response = await fetch(url,{\n        method: 'POST',\n        mode: 'cors',\n        headers: {\n            Authorization: token,\n            'Content-Type': 'application/json'\n        },\n        body: stringBody\n    });\n    if (response.status === 500) {\n        console.error(\"500 response:\", response);\n        return;\n    }\n    try {\n        const res = await response.json();\n        // if you try to: return response.json, it will get error below\n        // Unhandled Rejection (TypeError): Failed to execute 'json' on 'Response': body stream is locked\n        // but assiging it to a vairable somehow magically works.\n        return res;\n    } \n    catch (err) {\n        console.error('fetch search users failed', response)\n    }\n}\n\n/**\n * returns uesr id of the logged in user\n * @param token kbase session cookie\n */\nexport async function fetchLoggedInUserAPI(token:string) {\n    const authMeUrl = serviceUrl + '/auth/me';\n    let response;\n    try {\n        response = await fetch(authMeUrl, {\n            method: 'GET',\n            mode: 'cors',\n            headers: {\n                Authorization: token,\n                'Content-Type': 'application/json'\n            }\n        });\n        \n    }\n    catch (error) {\n        console.error(\"fetch logged user failed\", error);\n    }\n    if ( response ) {\n        try {\n            const res_json = await response.json();\n            return res_json.user;\n        }\n        catch (error) {\n            console.error(\"fetch logged user failed\", error);\n        }\n    }\n}\n","import React from 'react';\nimport { Select } from 'antd';\nimport { Store } from '../pages/Home';\nimport { filteredUserAPI } from '../util/API';\nconst { Option } = Select;\n\ninterface FilteredUser {\n    username: string;\n    realname: string;\n}\n\ninterface Response {\n    version: string;\n    result: Array<any>\n}\n\ninterface State {\n    data: Array<FilteredUser>;\n    mouseLeave: boolean;\n}\n\ninterface Props {\n    token: string;\n    hostName: string;\n}\n/**\n * View component with user search feature. \n * @param props \n */\nclass SearchUsers extends React.Component<Props, State>{\n    constructor(props:Store) {\n        super(props);\n        this.state = {\n            data: [],\n            mouseLeave: false\n        }\n        this.onChangeHandler = this.onChangeHandler.bind(this);\n        this.onSearchHandler = this.onSearchHandler.bind(this);\n        this.onMouseLeaveHandler = this.onMouseLeaveHandler.bind(this);\n        this.onMouseEnterHandler = this.onMouseEnterHandler.bind(this);\n    }\n    \n    \n    onSearchHandler(value:string): void{\n        if(value.length>2  && this.state.mouseLeave !== true){\n            filteredUserAPI(value, this.props.token)\n            .then((response:Response)=>{ \n                if(typeof response !== \"undefined\") {\n                    this.setState({data: response['result'][0]});\n                }\n                else {\n                    this.setState({data: [\n                        { username: 'error', realname: 'Something went wrong. Try again later.'}\n                    ]})\n                }\n            })\n        } else {return}\n    };\n    onMouseLeaveHandler(): void{\n        this.setState( { mouseLeave: true } )\n    };\n    onMouseEnterHandler(): void{\n        this.setState( { mouseLeave: false } )\n    };\n    onChangeHandler(value:string): void{\n        if(value !== \"error\" && typeof value !== 'undefined') {\n            let url = 'http://localhost:3000/?' + value; // for dev version\n            // let url = this.props.hostName + value; \n            window.open(url, '_blank');\n        }\n    };\n\n    render() {\n        let data = this.state.data;\n        return (\n            <Select\n                mode=\"single\" style={{ width: 300 }}\n                allowClear\n                showSearch\n                placeholder=\"enter more than 3 characters\"\n                showArrow={false}\n                onSearch={this.onSearchHandler}\n                onChange={this.onChangeHandler}\n                onMouseLeave={this.onMouseLeaveHandler}\n                onMouseEnter={this.onMouseEnterHandler}\n                optionFilterProp=\"children\"\n                filterOption={(inputValue, option)=>{\n                    return true\n                }}\n            >\n                {data.map((item)=>{\n                   return (<Option key={item['username']}>{item['realname']} ({item['username']})</Option>)\n                })}\n            </Select>\n        )\n    }\n}\n\nexport default SearchUsers;","import React from 'react';\nimport { connect} from 'react-redux';\n\nimport SearchUsers from './SearchUsers';\nimport { Store } from '../pages/Home';\n\n// function mapStateToProps(state:Store) {\n//     return state\n// }\nconst mapStateToProps = (state:Store) => {\n    return state\n}\nfunction SearchUsersRedux(mapStateToProps:Store) {\n    return (\n        <SearchUsers token={mapStateToProps.token} hostName={mapStateToProps.hostName}/>\n    )\n}\n\nexport default connect(mapStateToProps)(SearchUsersRedux);","import React from 'react';\nimport { Tabs } from 'antd';\nimport Profile from '../components/Profile';\nimport Narratives from '../components/Narratives';\nimport SearchUsersRedux from '../components/SearchUsersRedux';\nimport { fetchLoggedInUserAPI, fetchOrgsOfProfileAPI, fetchProfileAPI, fetchNarrativesAPI } from '../util/API';\n\nconst TabPane = Tabs.TabPane;\n/**\n * Class component that keeps states for all the variables that viewer/child components needs.\n * This can converted into Redux if needed.\n * Parent component App.tsx\n */\n\n// add Narrative_detail if needed. Currently, data in the object is not used - Akiyo.\nexport interface Narrative_detail {\n    creator: string;\n}\n\nexport interface NarrativeData {\n    wsID: string;\n    permission: string;\n    name: string;\n    last_saved: number;\n    users: object;\n    narrative_detail: Narrative_detail;\n}\n\n// org data that \nexport interface OrgProp {\n    name: string;\n    url: string;\n}\n\n// fetchOrgsOfProfile returns a full group info, \n// but only name and id is needed to make OrgProp \nexport interface Org {\n    name: string;\n    id: string;\n}\n\nexport interface Affiliation {\n    title: string;\n    organization: string;\n    started: string;\n    ended: string;\n}\nexport interface ProfileData {\n    organization: string;\n    department: string;\n    city: string;\n    state: string;\n    postalCode: string;\n    country: string;\n    affiliations: Array<Affiliation>;\n    researchStatement: string;\n    jobTitle: string;\n    jobTitleOther: string;\n    researchInterests: Array<string>;\n    fundingSource: string;\n    gravatarDefault: string;\n    avatarOption: string;\n}\n\nexport interface UserName {\n    name: string;\n    userID: string;\n}\ninterface State {\n    token: string;\n    proxy: string;\n    tabTitle: Array<string>;\n    userName: UserName;\n    loggedInUser: string;\n    userProfile: ProfileData;\n    userProfileLoaded: Boolean;\n    narratives: Array<NarrativeData>;\n    narrativesLoaded: Boolean;\n    sharedNarratives: Array<NarrativeData>;\n    sharedNarrativesLoaded: Boolean;\n    organizations: Array<OrgProp>;\n    organizationsLoaded: Boolean;\n    gravatarHash: string;\n};\n\nexport interface Store {\n    hostName: string;\n    token: string;\n    loggedInUser: string;\n}\n\n\nclass Home extends React.Component<Store, State> {\n    constructor(props: Store) {\n        super(props);\n        this.state = {\n            token: '3SLUNTKN5UABYMKHIB5QINDHTSQP442M',\n            proxy: 'https://narrative.kbase.us',\n            tabTitle: ['Profile', 'Narratives', 'Shared narratives', 'Search users'],\n            userName: {\n                name: '',\n                userID: '',\n            },\n            loggedInUser: '',\n            userProfile: {\n                organization: '',\n                department: '',\n                city: '',\n                state: '',\n                postalCode: '',\n                country: '',\n                affiliations: [],\n                researchStatement: '',\n                jobTitle: '',\n                jobTitleOther: '',\n                researchInterests: [],\n                fundingSource: '',\n                gravatarDefault: '',\n                avatarOption: '',\n            },\n            userProfileLoaded: false,\n            narratives: [],\n            narrativesLoaded: false,\n            sharedNarratives: [],\n            sharedNarrativesLoaded: false,\n            organizations: [],\n            organizationsLoaded: false,\n            gravatarHash: '',\n        }\n    }\n\n\n    componentDidMount() {\n        const userID = window.location.search.replace('?', '');\n        /**\n         * fetch user profile \n         *  @param {string} id  profile ID\n         */\n        fetchProfileAPI(userID)\n            .then((response) => {\n                if(typeof response !== 'undefined') {\n                    this.setState({\n                        userName: {\n                            name: response['user']['realname'],\n                            userID: response['user']['username']\n                        },\n                        gravatarHash: response['profile']['synced']['gravatarHash'],\n                        userProfile: response['profile']['userdata'],\n                        userProfileLoaded: true\n                    })\n                } else {\n                    // something went wrong during fetching.  \n                    this.setState({\n                        userName: {\n                            name: 'Something went wrong. Please Please check console for error messages..',\n                            userID: ''\n                        }\n                    })\n                }\n            });\n\n        /**\n         * fetch orgs that user blongs to the profile \n         *  @param {string} id  profile ID\n         */\n        fetchOrgsOfProfileAPI(userID, this.state.token)\n            .then((response: Array<Org>) => {\n                let orgArr: Array<OrgProp> = [];\n                if( typeof response !== 'undefined'){\n                    response.forEach(org => {\n                        orgArr.push({ 'name': org.name, 'url': this.state.proxy + '/#org/' + org.id })\n                    });\n                    this.setState(\n                        { \n                            organizations: orgArr,\n                            organizationsLoaded: true,\n                        }\n                    )\n                } else {\n                    // something went wrong during fetching.\n                    this.setState(\n                        { \n                            organizations: [{name: 'Something went wrong. Please check console for error messages.', url:''}],\n                            organizationsLoaded: true,\n                        }\n                    )\n                }\n            });\n\n        /**\n         * Returns narratives that shows in Narrative table.\n         * @param {string} token Auth Token/cookie\n         * \n         * fetch who is logged in first and determine which set of narratives needs to be fetched.\n         * fetchLoggedInUser uses url search parameter.\n         * if the viewing profile userid is not the logged in user, \n         * then fetch all of shared and public narrative and filter with the viewing profile userid.\n         */\n\n        fetchLoggedInUserAPI(this.state.token)\n            .then((response: string) => {\n                if(typeof response === 'undefined') {\n                    // something went wrong during fetching.\n                    this.setState(\n                        { \n                            narratives: [\n                                {\n                                    wsID: '',\n                                    permission: '',\n                                    name: 'Something went wrong. Please check console for error messages.',\n                                    last_saved: 1,\n                                    users: {},\n                                    narrative_detail: {creator: ''}\n                                }\n                            ],\n                            narrativesLoaded: true\n                        }\n                        );\n                        return\n                    }\n                    // fetch user was successful \n                    const userid = window.location.search.replace('?', '');\n                    this.setState({ loggedInUser: response });\n                    if (response === userid) {\n                        fetchNarrativesAPI('mine', this.state.token)\n                        .then((response: Array<NarrativeData>) => {\n                        if(typeof response !== 'undefined') {\n                            this.setState(\n                                { \n                                    narratives: response,\n                                    narrativesLoaded: true\n                                }\n                            );\n                        } else {\n                            // fetch failed\n                            this.setState(\n                                { \n                                    narratives: [\n                                        {\n                                            wsID: '',\n                                            permission: '',\n                                            name: 'Something went wrong. Please check console for error messages.',\n                                            last_saved: 0,\n                                            users: {},\n                                            narrative_detail: {creator: ''}\n                                        }\n                                    ],\n                                    narrativesLoaded: true\n                                }\n                            );\n                        }\n                    });\n                    fetchNarrativesAPI('shared', this.state.token)\n                        .then((response: Array<NarrativeData>) => {\n                            if(typeof response !== 'undefined') {\n                                this.setState(\n                                    { \n                                        sharedNarratives: response,\n                                        sharedNarrativesLoaded: true\n                                    }\n                                );\n                            } else {\n                                // something went wrong during fetching.\n                                this.setState(\n                                    { \n                                        sharedNarratives: [\n                                            {\n                                                wsID: '',\n                                                permission: '',\n                                                name: 'Something went wrong. Please check console for error messages.',\n                                                last_saved: 0,\n                                                users: {},\n                                                narrative_detail: {creator: ''}\n                                            }\n                                        ],\n                                        sharedNarrativesLoaded: true\n                                    }\n                                );\n                            }\n                        })\n                } else {\n                    let publicNarratives = fetchNarrativesAPI('public', this.state.token)\n                        .then((response: Array<NarrativeData>) => {\n                            if(typeof response === 'undefined') {\n                                // fetch failed.\n                                this.setState(\n                                    { \n                                        narratives: [\n                                            {\n                                                wsID: '',\n                                                permission: '',\n                                                name: 'Something went wrong. Please check console for error messages.',\n                                                last_saved: 0,\n                                                users: {},\n                                                narrative_detail: {creator: ''}\n                                            }\n                                        ],\n                                        narrativesLoaded: true\n                                    }\n                                );\n                                return\n                            } \n                            return response \n                        });\n                    let sharedNarratives = fetchNarrativesAPI('shared', this.state.token)\n                        .then((response: Array<NarrativeData>) => { return response });\n                    Promise.all([publicNarratives, sharedNarratives]).then(\n                        (values) => {\n                            let sharedNarrativeList = [];\n                            if(typeof values[1] !== 'undefined'){\n                                for (let i = 0; i < values[1].length; i++) {\n                                    let narrative = values[1][i];\n                                    if (narrative.narrative_detail.creator !== userID) {\n                                        for (let user in narrative.users) {\n                                            if (user === userID) {\n                                                sharedNarrativeList.push(narrative);\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n\n                            let narrativeList = [];\n                            if(typeof values[0] !== 'undefined'){\n                                let allNarratives = values[0].concat(values[1]);\n                                for (let i = 0; i < allNarratives.length; i += 1) {\n                                    if (allNarratives[i]['narrative_detail']['creator'] === userid) {\n                                        narrativeList.push(allNarratives[i]);\n                                    }\n                                }\n                            }\n                            this.setState(\n                                { \n                                    narratives: narrativeList,\n                                    narrativesLoaded: true,\n                                    sharedNarratives: sharedNarrativeList,\n                                    sharedNarrativesLoaded: true\n                                }\n                            )\n                        }\n                    )\n                }\n            });\n    }\n\n    componentDidUpdate(prevProps: any, prevState: any) {\n        // This privents from infinate component loading loop.\n        if (this.state === prevState) {\n            return\n        }\n    }\n\n    render() {\n        return (\n            <Tabs type='line' defaultActiveKey=\"1\">\n                <TabPane tab=\"Profile\" key=\"1\">\n                    <Profile \n                        userName={this.state.userName} \n                        userProfile={this.state.userProfile} \n                        orgs={this.state.organizations} \n                        gravatarHash={this.state.gravatarHash} \n                        profileloaded={this.state.userProfileLoaded}\n                        orgsloaded={this.state.organizationsLoaded}\n                        token={this.props.token}\n                    />\n                </TabPane>\n                <TabPane tab=\"Narratives\" key=\"3\">\n                    <Narratives \n                        loggedInUser={this.state.loggedInUser} \n                        narratives={this.state.narratives} \n                        narrativesloaded={this.state.narrativesLoaded}\n                        token={this.props.token}\n                    />\n                </TabPane>\n                <TabPane tab=\"Search other users\" key=\"6\">\n                    < SearchUsersRedux />\n                </TabPane>\n            </Tabs>\n        );\n    }\n}\n\nexport default Home;","import React from 'react';\nimport { connect } from 'react-redux';\n\nimport Home from './Home';\nimport { Store } from '../pages/Home';\n\nconst mapStateToProps = (state:Store) => {\n    console.log(state)\n    return state\n}\nfunction HomeRedux(mapStateToProps:Store) {\n    return (\n        <Home loggedInUser={mapStateToProps.loggedInUser} token={mapStateToProps.token} hostName={mapStateToProps.hostName}/>\n    )\n}\n\nexport default connect(mapStateToProps)(HomeRedux);","import React from 'react';\nimport { Layout } from 'antd';\nimport { Provider } from 'react-redux';\nimport { createReduxStore } from \"./redux/store\";\nimport { AppBase, DevWrapper } from \"@kbase/ui-lib\";\n// import store from './redux/store_basic';\nimport './App.css';\nimport HomeRedux from './pages/HomeRedux';\nconst { Content } = Layout;\nconst store = createReduxStore();\ninterface AppProps {}\ninterface AppState {}\n\nconst App: React.FC = () => {\n    return (\n        <Provider store={store}>\n            <DevWrapper>\n                <AppBase>\n                    <div className=\"App\">\n                        <Layout style={{ minHeight: '100vh' }}>\n                            <Content style={{ backgroundColor: 'white' }}>\n                                <HomeRedux />\n                            </Content>\n                        </Layout>\n                    </div>\n                </AppBase>\n            </DevWrapper>\n        </Provider>\n    );\n}\n\nexport default App;\n","import { BaseStoreState, makeBaseStoreState } from \"@kbase/ui-lib\";\nimport { createStore, compose, applyMiddleware } from \"redux\";\nimport thunk from \"redux-thunk\";\nimport reducer from \"./reducer\";\n\nexport interface StoreState extends BaseStoreState {}\n\nexport function makeInitialStoreState(): StoreState {\n  const baseStoreState = makeBaseStoreState();\n  return {\n    ...baseStoreState\n  };\n}\n\nexport function createReduxStore() {\n  return createStore(reducer, makeInitialStoreState(), compose(applyMiddleware(thunk)));\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n//TODO:AKIYO add service worker\n"],"sourceRoot":""}